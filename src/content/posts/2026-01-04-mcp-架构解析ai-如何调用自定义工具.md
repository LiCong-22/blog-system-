---
title: "MCP 架构解析：AI 如何调用自定义工具"
description: "解析 MCP 协议如何让 AI 调用自定义工具，包括架构设计和代码实现。"
pubDate: 2026-01-04
updatedDate: 2026-01-04
tags: ["MCP", "AI", "技术架构", "Python"]
---

# MCP 架构解析：AI 如何调用自定义工具

之前有朋友问我，MCP 是怎么让 AI 调用我写的 Python 代码的？今天来详细讲讲。

## MCP 是什么？

MCP (Model Context Protocol) 是一个让 AI 模型能够调用外部工具的协议标准。

## 工作流程

```
AI 模型 (Claude)
       │
       │ 识别需要调用工具
       ▼
MCP Client (Claude Code CLI)
       │ stdin/stdout 通信
       ▼
MCP Server (Python)
       │ 执行代码
       ▼
GitHub → Vercel 部署
```

![MCP 架构图](/mcp-architecture.jpg)

## 核心代码

### 1. 定义工具

```python
@server.list_tools()
async def list_tools() -> list[Tool]:
    return [
        Tool(
            name='create_blog_post',
            description='创建博客文章',
            inputSchema={
                'type': 'object',
                'properties': {
                    'title': {'type': 'string'},
                    'content': {'type': 'string'},
                    'tags': {'type': 'array'}
                }
            }
        )
    ]
```

### 2. 调用工具

```python
@server.call_tool()
async def call_tool(name, arguments):
    if name == 'create_blog_post':
        result = create_blog_post(
            title=arguments['title'],
            content=arguments['content'],
            tags=arguments.get('tags', [])
        )
        return f'博客已创建: {result}'
```

## 我的实现

我写了一个简单的 MCP Server，包含：

- **blog_tool.py** - 博客发布核心逻辑
  - 创建 Markdown 文件
  - 执行 Git 提交推送

- **server.py** - MCP 协议层
  - 声明可用工具
  - 处理工具调用请求

## 使用效果

对话变成博客的完整流程：

1. 用户说："帮我把这段对话总结成博客"
2. AI 识别意图，调用 `create_blog_post` 工具
3. MCP Server 接收请求，自动：
   - 生成带日期的 Markdown 文件
   - 写入 `src/content/posts/`
   - 提交到 GitHub
4. Vercel 自动部署
5. 返回博客链接

整个过程 AI 自动完成，我只需要专注于内容！

## 总结

MCP 的核心价值：**让 AI 能够执行你定义的任意代码逻辑**。

无论是发布博客、操作数据库、调用 API，只要写好 Python 函数，AI 就能调用它。
